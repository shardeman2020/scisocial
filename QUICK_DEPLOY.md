# Quick Deployment Reference

## TL;DR - Deploy in 5 Minutes

### Option 1: Vercel + Render (Easiest)

**1. Frontend (Vercel):**
```bash
cd frontend
npm i -g vercel
vercel --prod
```
Add domain `scisocial.pro` in Vercel dashboard.

**2. Backend (Render):**
```bash
# Push to GitHub
git init
git add .
git commit -m "Deploy to production"
git remote add origin https://github.com/YOUR_USERNAME/scisocial.git
git push -u origin main
```

Then:
- Go to render.com → New → Blueprint
- Connect GitHub repo
- Render detects `backend/render.yaml`
- Click "Apply"
- After deploy, run in Shell: `npm run generate:embeddings`

**Done!** ✅

---

## Environment Variables Checklist

### Frontend (.env.production)
```bash
NEXT_PUBLIC_API_URL=https://api.scisocial.pro
NEXT_PUBLIC_APP_NAME=SciSocial
NEXT_PUBLIC_ENV=production
```

### Backend (.env.production or Render Dashboard)
```bash
# Auto-configured by Render:
DATABASE_URL=postgresql://...
REDIS_URL=redis://...

# YOU MUST ADD:
CROSSREF_API_EMAIL=your-email@example.com
ANTHROPIC_API_KEY=sk-ant-api03-xxxxx
EMAIL_HOST=smtp.sendgrid.net
EMAIL_USER=apikey
EMAIL_PASSWORD=SG.xxxxx

# Auto-generated by Render:
JWT_SECRET=automatically-generated
```

---

## DNS Configuration (Cloudflare)

| Type | Name | Value | Proxy |
|------|------|-------|-------|
| CNAME | @ | cname.vercel-dns.com | DNS Only |
| CNAME | www | cname.vercel-dns.com | DNS Only |
| CNAME | api | your-app.onrender.com | DNS Only |

Enable in Cloudflare:
- SSL/TLS → Full (strict)
- Always Use HTTPS: On
- HSTS: On (12 months, include subdomains)

---

## Post-Deployment Checklist

- [ ] Frontend loads: https://scisocial.pro
- [ ] API health check: https://api.scisocial.pro/health
- [ ] WWW redirects: https://www.scisocial.pro → https://scisocial.pro
- [ ] Generate embeddings: `npm run generate:embeddings` (in Render Shell)
- [ ] Test semantic search: `curl "https://api.scisocial.pro/semantic-search?q=test"`
- [ ] SSL grade A+: https://www.ssllabs.com/ssltest/analyze.html?d=scisocial.pro

---

## Useful Commands

**Test health:**
```bash
curl https://api.scisocial.pro/health
```

**Test semantic search:**
```bash
curl "https://api.scisocial.pro/semantic-search?q=neuroscience&limit=5"
```

**Test hybrid search:**
```bash
curl "https://api.scisocial.pro/semantic-search?q=Nature&hybrid=true"
```

**Render Shell commands:**
```bash
# Generate embeddings
npm run generate:embeddings

# Check logs
pm2 logs

# Restart service
pm2 restart all
```

---

## Troubleshooting

**CORS Error:**
- Add frontend URL to `CORS_ORIGIN` in backend env vars
- Format: `https://scisocial.pro,https://www.scisocial.pro`

**502 Bad Gateway:**
- Check backend is running (Render dashboard)
- Check health endpoint: `/health`

**Embeddings not working:**
- Run: `npm run generate:embeddings` in Render Shell
- Check pgvector extension: `CREATE EXTENSION IF NOT EXISTS vector;`

**Email not sending:**
- Verify SMTP credentials in Render env vars
- Test: Check logs for email errors

---

For detailed instructions, see [DEPLOYMENT_GUIDE.md](./DEPLOYMENT_GUIDE.md)
